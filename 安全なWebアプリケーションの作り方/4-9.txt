■メールに関する脆弱性
メール送信に関する脆弱性について記載する。

★メールヘッダインジェクション
メールのヘッダ部分に改行を挿入することで任意のフィールドを追加する攻撃手法である。
詳細は後述。

★hiddenパラメータの改ざん
ヘッダインジェクションとは、to/subject等のメールヘッダを外部から指定する場合に発生する。
改行文字を利用して、メールヘッダに任意のヘッダを追加する。
以下の様な問題が発生する可能性がある。
1.件名や送信元、本文が改ざんされる。
2.迷惑メールの送信に悪用される。
3.ウイルスメールの送信に悪用される。

対策として、以下を考える。
1.外部からのパラメータをメールヘッダに含めないようにする。
　→渡されたパラメータをチェック、ヘッダを含む場合はエラーとする。