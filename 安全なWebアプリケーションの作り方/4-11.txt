■OSコマンドの呼び出しに対する脆弱性
Webアプリケーションの中にはOSのコマンドをシェル経由で実行するライブラリを備えるものが存在する。
この処理に攻撃者が任意のコマンドを渡すことで、
想定しないコマンドが実行される脆弱性が発生する。
これをOSコマンドインジェクションと呼ぶ。

以下の様な攻撃の例を考える。
1.OSコマンドインジェクションを用いて攻撃用ツールをサーバにダウンロードさせる。
2.ダウンロードしたツールに実行権限を与える。
3.ツールを実行し、OSの脆弱性を攻撃し、管理者権限を取得する。

★OSコマンドインジェクションを用いた攻撃例
以下の様なPHPの関数を考える。
system.("/usr/sbin/sendmail < -i < template.txt $mail")
OSのコマンドであるsendmailに対し、$mailの内容を展開し送信する内容である。
ここで以下の様な値を$mailに渡す。
hoge@hoge.com;cat /etc/passwd
hoge@hoge.comに対し、正常なメールが送信された後、cat /etc/passwdが実行される。
この脆弱性を用いることでOSで実行可能なコマンドを悪用可能となる。

★脆弱性の要因
OSコマンドを用いる場合、パイプ/リダイレクト等の機能が利用可能になる。
これは柔軟性を持つと同時に任意のコマンドを実行できる危険性を含む。
OSコマンドインジェクションが悪用される条件は以下の3つを全て満たす場合に成立する。
1.OSコマンドを利用するsystem,open等の関数を使用している。
2.利用者からのパラメータをsystem,open等の関数に渡している。
3.利用者からのパラメータに含まれるシェルのメタ文字($;|等)をエスケープしていない。

★OSコマンドインジェクションの対策